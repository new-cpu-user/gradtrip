<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sol de Ayer — Brochures</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;0,700;1,400&family=DM+Sans:wght@400;500;600&display=swap" rel="stylesheet" />
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }
    body {
      font-family: 'DM Sans', system-ui, sans-serif;
      background: #FAF8F3;
      color: #1A2E4C;
    }

    @keyframes fadeInOverlay {
      from { opacity: 0; }
      to   { opacity: 1; }
    }
    @keyframes scaleUp {
      from { transform: scale(0.92) translateY(20px); opacity: 0; }
      to   { transform: scale(1) translateY(0); opacity: 1; }
    }
    @keyframes rackFadeIn {
      from { opacity: 0; transform: translateY(30px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    @keyframes pageTurnIn {
      from { opacity: 0; transform: perspective(1200px) rotateY(-6deg) scale(0.97); }
      to   { opacity: 1; transform: perspective(1200px) rotateY(0deg) scale(1); }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.3.1/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.3.1/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.24.7/babel.min.js"></script>

  <script type="text/babel">
    const { useState, useRef, useEffect, useCallback, useMemo } = React;

    /* ─────────────────────────────────────────────────────
     *  PDF.js loader — loaded once, globally
     * ───────────────────────────────────────────────────── */
    const pdfjsReady = (function () {
      const script = document.createElement("script");
      script.src = "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js";
      document.head.appendChild(script);
      return new Promise((resolve) => {
        script.onload = () => {
          const lib = window.pdfjsLib;
          lib.GlobalWorkerOptions.workerSrc =
            "https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js";
          resolve(lib);
        };
      });
    })();


    /* ─────────────────────────────────────────────────────
     *  MAGAZINE DATA
     * ───────────────────────────────────────────────────── */
    const MAGAZINES = [
      { id: "argentina",    title: "Viaje de Graduación — Argentina", pdf: "pdfs/Magazine_1.pdf",    top: 2,  left: 12.5, width: 21,   height: 50 },
      { id: "buenos-aires", title: "Buenos Aires Eterna",            pdf: "pdfs/Magazine_2.pdf", top: 2,  left: 34.5, width: 19.5, height: 50 },
      { id: "iguazu",       title: "Cataratas del Iguazú",           pdf: "pdfs/Magazine_3.pdf",       top: 2,  left: 54.5, width: 20,   height: 50 },
      { id: "salta",        title: "National Geographic — Salta",    pdf: "pdfs/Magazine_4.pdf",        top: 57, left: 14,   width: 18.5, height: 37 },
      { id: "gastronomia",  title: "National Gastronomía",           pdf: "pdfs/Magazine_5.pdf",  top: 57, left: 35,   width: 18,   height: 37 },
      { id: "patagonica",   title: "National Patagónica",            pdf: "pdfs/Magazine_6.pdf",   top: 57, left: 55,   width: 18.5, height: 37 },
    ];


    /* ══════════════════════════════════════════════════════
     *  MAGAZINE-STYLE PDF VIEWER
     *
     *  Spread layout (always even page-count PDFs):
     *    Spread 0  →  [page 1]            cover, alone
     *    Spread 1  →  [page 2, page 3]    first content spread
     *    Spread 2  →  [page 4, page 5]    …
     *    Spread N  →  [last page]          back cover, alone
     * ══════════════════════════════════════════════════════ */

    function buildSpreads(totalPages) {
      const spreads = [];
      spreads.push([1]);
      for (let p = 2; p < totalPages; p += 2) spreads.push([p, p + 1]);
      spreads.push([totalPages]);
      return spreads;
    }


    /* ── Renders one PDF page to <canvas> ──────────────── */
    function PdfPage({ pdfDoc, pageNum, maxH }) {
      const canvasRef = useRef(null);
      const taskRef   = useRef(null);

      useEffect(() => {
        let dead = false;

        (async () => {
          if (!pdfDoc || !canvasRef.current) return;
          const page = await pdfDoc.getPage(pageNum);
          if (dead) return;

          const canvas = canvasRef.current;
          const ctx    = canvas.getContext("2d");
          const dpr    = window.devicePixelRatio || 1;
          const raw    = page.getViewport({ scale: 1 });
          const scale  = (maxH / raw.height) * dpr;
          const vp     = page.getViewport({ scale });

          canvas.width  = vp.width;
          canvas.height = vp.height;
          canvas.style.width  = (vp.width  / dpr) + "px";
          canvas.style.height = (vp.height / dpr) + "px";

          if (taskRef.current) taskRef.current.cancel();
          const t = page.render({ canvasContext: ctx, viewport: vp });
          taskRef.current = t;
          try { await t.promise; } catch (e) {
            if (e.name !== "RenderingCancelled") console.error(e);
          }
        })();

        return () => { dead = true; };
      }, [pdfDoc, pageNum, maxH]);

      return (
        <canvas
          ref={canvasRef}
          style={{ display: "block", background: "#fff" }}
        />
      );
    }


    /* ── Full magazine viewer overlay ──────────────────── */
    function MagazineViewer({ magazine, onClose }) {
      const overlayRef = useRef(null);
      const [pdfDoc,   setPdfDoc]   = useState(null);
      const [spreads,  setSpreads]  = useState([]);
      const [idx,      setIdx]      = useState(0);
      const [loading,  setLoading]  = useState(true);
      const [maxH,     setMaxH]     = useState(540);

      /* Load the PDF document */
      useEffect(() => {
        let dead = false;
        (async () => {
          const lib = await pdfjsReady;
          const doc = await lib.getDocument(magazine.pdf).promise;
          if (dead) return;
          setPdfDoc(doc);
          setSpreads(buildSpreads(doc.numPages));
          setIdx(0);
          setLoading(false);
        })();
        return () => { dead = true; };
      }, [magazine.pdf]);

      /* Measure available height (leave room for controls) */
      useEffect(() => {
        const m = () => setMaxH(Math.min(window.innerHeight * 0.68, 720));
        m();
        window.addEventListener("resize", m);
        return () => window.removeEventListener("resize", m);
      }, []);

      /* Keyboard: arrows + Escape */
      useEffect(() => {
        const h = (e) => {
          if (e.key === "Escape") onClose();
          if (e.key === "ArrowRight" || e.key === "ArrowDown")
            setIdx(i => Math.min(i + 1, spreads.length - 1));
          if (e.key === "ArrowLeft" || e.key === "ArrowUp")
            setIdx(i => Math.max(i - 1, 0));
        };
        document.addEventListener("keydown", h);
        document.body.style.overflow = "hidden";
        return () => {
          document.removeEventListener("keydown", h);
          document.body.style.overflow = "";
        };
      }, [onClose, spreads.length]);

      const cur       = spreads[idx] || [];
      const isSingle  = cur.length === 1;
      const isFirst   = idx === 0;
      const isLast    = idx === spreads.length - 1;
      const total     = pdfDoc ? pdfDoc.numPages : 0;

      const pageLabel = useMemo(() => {
        if (!cur.length) return "";
        if (isSingle) return "Page " + cur[0] + " of " + total;
        return "Pages " + cur[0] + "\u2013" + cur[1] + " of " + total;
      }, [cur, total, isSingle]);

      /* Click area navigation (left half = prev, right half = next) */
      const handleAreaClick = (e) => {
        const rect = e.currentTarget.getBoundingClientRect();
        const x = e.clientX - rect.left;
        if (x < rect.width / 2) {
          setIdx(i => Math.max(i - 1, 0));
        } else {
          setIdx(i => Math.min(i + 1, spreads.length - 1));
        }
      };

      return (
        <div
          ref={overlayRef}
          onClick={(e) => { if (e.target === overlayRef.current) onClose(); }}
          style={{
            position: "fixed", inset: 0, zIndex: 9999,
            background: "rgba(10,10,12,0.88)",
            backdropFilter: "blur(12px)", WebkitBackdropFilter: "blur(12px)",
            display: "flex", flexDirection: "column",
            alignItems: "center", justifyContent: "center",
            animation: "fadeInOverlay 0.25s ease-out",
          }}
        >
          {/* ── Top bar ─────────────────────────────── */}
          <div style={{
            position: "absolute", top: 0, left: 0, right: 0,
            display: "flex", alignItems: "center", justifyContent: "space-between",
            padding: "14px 24px",
            background: "linear-gradient(180deg, rgba(18,18,22,0.95) 0%, transparent 100%)",
            zIndex: 10, pointerEvents: "auto",
          }}>
            <span style={{
              fontFamily: "'DM Sans', sans-serif",
              fontSize: 14, fontWeight: 600, color: "#d5d0c6",
            }}>
              {magazine.title}
            </span>
            <button
              onClick={onClose}
              aria-label="Close"
              onMouseEnter={(e) => {
                e.currentTarget.style.background = "rgba(255,80,80,0.15)";
                e.currentTarget.style.color = "#ff6b6b";
              }}
              onMouseLeave={(e) => {
                e.currentTarget.style.background = "rgba(255,255,255,0.08)";
                e.currentTarget.style.color = "#999";
              }}
              style={{
                background: "rgba(255,255,255,0.08)",
                border: "1px solid rgba(255,255,255,0.08)",
                borderRadius: 8, width: 36, height: 36,
                cursor: "pointer", display: "flex",
                alignItems: "center", justifyContent: "center",
                color: "#999", fontSize: 18, fontWeight: 300,
                transition: "all 0.15s",
              }}
            >✕</button>
          </div>

          {/* ── Spread display ──────────────────────── */}
          {loading ? (
            <div style={{ color: "#888", fontFamily: "'DM Sans', sans-serif", fontSize: 15 }}>
              Loading magazine…
            </div>
          ) : (
            <div
              key={idx}
              onClick={handleAreaClick}
              style={{
                display: "flex", alignItems: "center", justifyContent: "center",
                gap: 0, cursor: "pointer", userSelect: "none",
                animation: "pageTurnIn 0.35s cubic-bezier(0.22,1,0.36,1)",
              }}
            >
              {cur.map((pageNum, pi) => (
                <div
                  key={pageNum}
                  style={{
                    position: "relative",
                    boxShadow: isSingle
                      ? "0 8px 40px rgba(0,0,0,0.4)"
                      : pi === 0
                        ? "4px 0 20px -4px rgba(0,0,0,0.4), -4px 0 20px -4px rgba(0,0,0,0.15)"
                        : "-4px 0 20px -4px rgba(0,0,0,0.4), 4px 0 20px -4px rgba(0,0,0,0.15)",
                    borderRadius: isSingle ? 4 :
                      pi === 0 ? "4px 0 0 4px" : "0 4px 4px 0",
                    overflow: "hidden",
                    background: "#fff",
                  }}
                >
                  <PdfPage pdfDoc={pdfDoc} pageNum={pageNum} maxH={maxH} />

                  {/* Inner-edge shadow (spine fold effect) */}
                  {!isSingle && (
                    <div style={{
                      position: "absolute", top: 0, bottom: 0,
                      width: 30, pointerEvents: "none",
                      ...(pi === 0
                        ? { right: 0,
                            background: "linear-gradient(to left, rgba(0,0,0,0.07) 0%, rgba(0,0,0,0.02) 40%, transparent 100%)" }
                        : { left: 0,
                            background: "linear-gradient(to right, rgba(0,0,0,0.07) 0%, rgba(0,0,0,0.02) 40%, transparent 100%)" }
                      ),
                    }} />
                  )}

                  {/* Very subtle page-edge shine */}
                  {!isSingle && (
                    <div style={{
                      position: "absolute", top: 0, bottom: 0,
                      width: 1, pointerEvents: "none",
                      background: "rgba(255,255,255,0.35)",
                      ...(pi === 0 ? { right: 0 } : { left: 0 }),
                    }} />
                  )}
                </div>
              ))}
            </div>
          )}

          {/* ── Bottom controls ─────────────────────── */}
          <div style={{
            position: "absolute", bottom: 0, left: 0, right: 0,
            display: "flex", alignItems: "center", justifyContent: "center",
            gap: 16, padding: "24px 24px 28px",
            background: "linear-gradient(0deg, rgba(18,18,22,0.95) 0%, transparent 100%)",
            zIndex: 10, pointerEvents: "auto",
          }}>
            {/* Prev button */}
            <NavBtn
              direction="prev"
              disabled={isFirst}
              onClick={() => setIdx(i => Math.max(i - 1, 0))}
            />

            {/* Page info + dots */}
            <div style={{
              display: "flex", flexDirection: "column",
              alignItems: "center", gap: 8, minWidth: 160,
            }}>
              <span style={{
                fontFamily: "'DM Sans', sans-serif",
                fontSize: 12, fontWeight: 500,
                color: "rgba(255,255,255,0.45)", letterSpacing: "0.04em",
              }}>
                {pageLabel}
              </span>
              <div style={{ display: "flex", gap: 6 }}>
                {spreads.map((_, si) => (
                  <button
                    key={si}
                    onClick={() => setIdx(si)}
                    aria-label={"Go to spread " + (si + 1)}
                    style={{
                      width:  si === idx ? 22 : 8,
                      height: 8, borderRadius: 4,
                      border: "none", padding: 0, cursor: "pointer",
                      background: si === idx
                        ? "rgba(255,200,100,0.8)"
                        : "rgba(255,255,255,0.18)",
                      transition: "all 0.3s cubic-bezier(0.4,0,0.2,1)",
                    }}
                  />
                ))}
              </div>
            </div>

            {/* Next button */}
            <NavBtn
              direction="next"
              disabled={isLast}
              onClick={() => setIdx(i => Math.min(i + 1, spreads.length - 1))}
            />
          </div>
        </div>
      );
    }


    /* ── Navigation button (prev / next) ───────────────── */
    function NavBtn({ direction, disabled, onClick }) {
      const [hov, setHov] = useState(false);
      const isPrev = direction === "prev";
      return (
        <button
          onClick={onClick}
          disabled={disabled}
          aria-label={isPrev ? "Previous spread" : "Next spread"}
          onMouseEnter={() => setHov(true)}
          onMouseLeave={() => setHov(false)}
          style={{
            background: hov && !disabled ? "rgba(255,255,255,0.14)" : "rgba(255,255,255,0.07)",
            border: "1px solid rgba(255,255,255,0.1)",
            borderRadius: 10, width: 44, height: 44,
            display: "flex", alignItems: "center", justifyContent: "center",
            cursor: disabled ? "default" : "pointer",
            opacity: disabled ? 0.25 : 1,
            transition: "all 0.15s", color: "#ccc",
          }}
        >
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" strokeWidth="2.2"
            strokeLinecap="round" strokeLinejoin="round">
            {isPrev
              ? <polyline points="15 18 9 12 15 6"/>
              : <polyline points="9 18 15 12 9 6"/>}
          </svg>
        </button>
      );
    }


    /* ══════════════════════════════════════════════════════
     *  HOTSPOTS + RACK
     * ══════════════════════════════════════════════════════ */

    function MagazineHotspot({ magazine, onClick }) {
      const [hov, setHov] = useState(false);
      return (
        <button
          onClick={() => onClick(magazine)}
          onMouseEnter={() => setHov(true)}
          onMouseLeave={() => setHov(false)}
          aria-label={"Open " + magazine.title}
          style={{
            position: "absolute",
            top: magazine.top + "%", left: magazine.left + "%",
            width: magazine.width + "%", height: magazine.height + "%",
            border: "none", padding: 0, cursor: "pointer",
            background: hov ? "rgba(255,200,100,0.08)" : "transparent",
            borderRadius: 4, outline: "none",
            transition: "all 0.35s cubic-bezier(0.4,0,0.2,1)",
            boxShadow: hov
              ? "inset 0 0 0 2px rgba(255,200,100,0.25), 0 0 30px rgba(255,180,60,0.12)"
              : "none",
            zIndex: 2,
          }}
        >
          <span style={{
            position: "absolute",
            bottom: "calc(100% + 8px)", left: "50%",
            transform: "translateX(-50%) translateY(" + (hov ? "0" : "6px") + ")",
            background: "rgba(20,20,24,0.92)", backdropFilter: "blur(8px)",
            color: "#e8e4db", fontFamily: "'DM Sans', sans-serif",
            fontSize: 12, fontWeight: 500,
            padding: "6px 12px", borderRadius: 6,
            whiteSpace: "nowrap", pointerEvents: "none",
            opacity: hov ? 1 : 0,
            transition: "all 0.25s cubic-bezier(0.4,0,0.2,1)",
            boxShadow: "0 4px 16px rgba(0,0,0,0.3)",
          }}>
            {magazine.title}
            <span style={{
              position: "absolute", top: "100%", left: "50%",
              transform: "translateX(-50%)",
              border: "5px solid transparent",
              borderTopColor: "rgba(20,20,24,0.92)",
            }} />
          </span>
        </button>
      );
    }


    /* ── Main section ──────────────────────────────────── */
    function BrochureRackSection() {
      const [activePdf, setActivePdf] = useState(null);
      const [visible,   setVisible]   = useState(false);
      const sectionRef = useRef(null);

      useEffect(() => {
        const el = sectionRef.current;
        if (!el) return;
        const obs = new IntersectionObserver(
          ([entry]) => { if (entry.isIntersecting) { setVisible(true); obs.disconnect(); } },
          { threshold: 0.1 }
        );
        obs.observe(el);
        return () => obs.disconnect();
      }, []);

      const handleOpen  = useCallback((m) => setActivePdf(m), []);
      const handleClose = useCallback(() => setActivePdf(null), []);

      return (
        <section
          ref={sectionRef}
          style={{
            position: "relative", padding: "80px 24px",
            background: "linear-gradient(180deg, #FAF8F3 0%, #F2EDE4 40%, #EBE6DB 100%)",
            minHeight: "100vh",
            display: "flex", flexDirection: "column",
            alignItems: "center", justifyContent: "center",
            overflow: "hidden",
          }}
        >
          {/* Header */}
          <div style={{
            textAlign: "center", marginBottom: 48,
            opacity: visible ? 1 : 0, transition: "opacity 0.6s ease-out",
          }}>
            <p style={{
              fontFamily: "'DM Sans', sans-serif",
              fontSize: 13, fontWeight: 600,
              textTransform: "uppercase", letterSpacing: "0.14em",
              color: "#A08B6A", marginBottom: 12,
            }}>Preguntas Frecuentes</p>
            <h2 style={{
              fontFamily: "'Cormorant Garamond', serif",
              fontSize: "clamp(30px, 5vw, 46px)",
              fontWeight: 700, color: "#1A2E4C",
              lineHeight: 1.1, marginBottom: 14,
              letterSpacing: "-0.02em",
            }}>Pick Up a Brochure</h2>
            <p style={{
              fontFamily: "'DM Sans', sans-serif",
              fontSize: 15, color: "#1A2E4C77",
              lineHeight: 1.6, maxWidth: 440, margin: "0 auto",
            }}>Everything you need to know — tap any magazine to read it.</p>
          </div>

          {/* Rack image + hotspots */}
          <div style={{
            position: "relative", maxWidth: 960, width: "100%",
            margin: "0 auto", opacity: visible ? 1 : 0,
            animation: visible ? "rackFadeIn 0.8s ease-out 0.2s backwards" : "none",
          }}>
            <img
              src="images/office_magazine_image_2.png"
              alt="Magazine display rack"
              style={{
                width: "100%", display: "block", borderRadius: 8,
                boxShadow: "0 20px 60px rgba(0,0,0,0.12), 0 8px 24px rgba(0,0,0,0.08)",
              }}
              draggable={false}
            />
            {MAGAZINES.map((m) => (
              <MagazineHotspot key={m.id} magazine={m} onClick={handleOpen} />
            ))}
          </div>

          {/* Footer */}
          <div style={{
            textAlign: "center", marginTop: 40,
            opacity: visible ? 1 : 0, transition: "opacity 0.6s ease-out 0.5s",
          }}>
            <p style={{ fontFamily: "'DM Sans', sans-serif", fontSize: 14, color: "#1A2E4C55" }}>
              Still have questions?{" "}
              <a href="https://instagram.com/soldeayer" target="_blank" rel="noopener noreferrer"
                style={{ color: "#FF8C00", fontWeight: 600, textDecoration: "none",
                  borderBottom: "1px solid #FF8C0044", transition: "border-color 0.2s" }}
                onMouseEnter={(e) => (e.target.style.borderColor = "#FF8C00")}
                onMouseLeave={(e) => (e.target.style.borderColor = "#FF8C0044")}
              >DM @soldeayer</a>
            </p>
          </div>

          {activePdf && <MagazineViewer magazine={activePdf} onClose={handleClose} />}
        </section>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<BrochureRackSection />);
  </script>
</body>
</html>
